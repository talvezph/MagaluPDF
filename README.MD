# üìñ Manual de Uso - Sistema de Fechamento PDF

## üéØ Objetivo
Este sistema automatiza o processamento de PDFs de motoristas para gerar fechamentos financeiros em planilhas Excel com f√≥rmulas din√¢micas.

## üõ†Ô∏è Instala√ß√£o

### Pr√©-requisitos
- Python 3.7+ instalado
- Pip (gerenciador de pacotes Python)

### Passos
1. **Extrair o projeto:**
   ```bash
   unzip projeto_fechamento.zip
   cd projeto_fechamento
   ```

2. **Instalar depend√™ncias:**
   ```bash
   pip install -r requirements.txt
   ```

3. **Configurar o sistema:**
   ```bash
   cp exemplos/exemplo_config.ini config.ini
   ```
   Edite o `config.ini` com seus caminhos e valores.

## üìÅ Estrutura de Arquivos Necess√°rios

### 1. Pasta de PDFs
```
pdfs/
‚îú‚îÄ‚îÄ joao_silva.pdf
‚îú‚îÄ‚îÄ joao_silva2.pdf      # M√∫ltiplos PDFs do mesmo motorista
‚îú‚îÄ‚îÄ maria_santos.pdf
‚îî‚îÄ‚îÄ pedro_oliveira.pdf
```

### 2. Planilha de Tipos de Ve√≠culos
Excel com as colunas:
- **Nome do Motorista** (ou "Motorista" ou "Nome")
- **Di√°ria Combinada** (ou "Diaria Combinada" ou "Diaria")
- **Tipo de Ve√≠culo** (qualquer coluna com "tipo" no nome)

Exemplo:
| Nome do Motorista | Di√°ria Combinada | Tipo de Ve√≠culo |
|-------------------|------------------|-----------------|
| JO√ÉO SILVA        | 120.00          | MOTO           |
| MARIA SANTOS      | 150.00          | CARRO          |
| PEDRO OLIVEIRA    | 140.00          | VAN            |

## üöÄ Usando o Launcher (Recomendado)

### 1. Iniciar o Launcher
```bash
python launcher.py
```

### 2. Interface do Launcher
- **Selecionar Script:** Escolha "Fechamento PDF" no dropdown
- **Descri√ß√£o:** Aparece automaticamente
- **Executar:** Clique no bot√£o ‚ñ∂ para iniciar
- **Acompanhar:** Veja logs em tempo real
- **Parar:** Use ‚èπ se necess√°rio

### 3. Monitoramento
- **Barra de Progresso:** Mostra que est√° executando
- **Status:** Indica o estado atual
- **Logs:** Detalhes em tempo real com cores:
  - üü¢ **Verde:** Sucesso
  - üü° **Laranja:** Avisos
  - üî¥ **Vermelho:** Erros
  - ‚ö´ **Preto:** Informa√ß√µes

## üíª Usando via Linha de Comando

### Comando B√°sico
```bash
python script_fechamento.py
```

### Com Par√¢metros Personalizados
```bash
python script_fechamento.py \
  --pdfs_folder "meus_pdfs/" \
  --type_sheet "minha_planilha.xlsx" \
  --output_excel "resultado_janeiro.xlsx" \
  --error_report "erros_janeiro.log"
```

## üìä Resultado Gerado

### Planilha Excel com:
- **Uma aba por motorista**
- **13 colunas** com dados e f√≥rmulas
- **Formata√ß√£o autom√°tica:**
  - Cabe√ßalho em azul claro
  - Linha "Total" em amarelo
- **F√≥rmulas Excel nativas** que recalculam automaticamente

### Colunas da Planilha:
1. **Data** - Data do registro
2. **Motorista** - Nome do motorista
3. **Tipo de Ve√≠culo** - Tipo do ve√≠culo
4. **Entregues** - Quantidade de entregas
5. **Insucessos** - Quantidade de insucessos
6. **Valor Entregas** - Valor das entregas
7. **Descontos** - Valor dos descontos
8. **Acr√©scimo Calculado** - Complemento da di√°ria
9. **Acr√©scimo Pago** - Acr√©scimos extra√≠dos do PDF
10. **Recebido** - `=Valor Entregas + Acr√©scimo Calculado`
11. **Total Dia** - `=Valor Entregas + Acr√©scimo Pago - Descontos`
12. **B√¥nus** - B√¥nus di√°rio quando aplic√°vel
13. **Diferen√ßa** - `=Recebido - Total Dia`

## üîß Configura√ß√£o Avan√ßada

### config.ini Detalhado
```ini
[Paths]
# Pasta com PDFs (pode ser relativa ou absoluta)
pdfs_folder = pdfs/

# Planilha de tipos (Excel com .xlsx ou .xls)
type_sheet = tipos_veiculos.xlsx

# Arquivo de sa√≠da (ser√° criado/sobrescrito)
output_excel = fechamento_final.xlsx

[Values]
# Valor por entrega (decimal com ponto)
delivery_value = 8.0

# B√¥nus di√°rio (decimal com ponto)
daily_bonus = 30.0
```

### Personaliza√ß√£o de Scripts no Launcher
Edite o `launcher.py` na se√ß√£o `scripts_config`:

```python
self.scripts_config = {
    "Meu Script Personalizado": {
        "file": "caminho/para/meu_script.py",
        "description": "Descri√ß√£o do que faz",
        "args": ["--arg1", "--arg2"],
        "required_files": ["arquivo_necessario.txt"]
    }
}
```

## üìà Dicas de Uso

### 1. Organiza√ß√£o de Arquivos
- **Nomes consistentes:** Use nomes similares para PDFs do mesmo motorista
- **Pasta organizada:** Mantenha PDFs em pasta espec√≠fica
- **Backup:** Fa√ßa backup dos PDFs originais

### 2. M√∫ltiplos PDFs por Motorista
- O sistema automaticamente consolida PDFs com nomes similares
- Exemplo: `joao.pdf`, `joao2.pdf`, `joao3.pdf` ‚Üí Uma aba "JOAO"

### 3. Valida√ß√£o de Dados
- **Verifique logs** para avisos sobre dados n√£o encontrados
- **Confira nomes** na planilha de tipos vs PDFs
- **Valide datas** nos PDFs (formato dd/mm/yyyy)

### 4. Solu√ß√£o de Problemas Comuns
- **Erro "Script n√£o encontrado":** Verifique caminho no config.ini
- **Erro "Planilha n√£o encontrada":** Confirme nome e extens√£o
- **Motorista n√£o encontrado:** Verifique nome na planilha de tipos
- **Valores zerados:** Verifique formato dos PDFs

## üÜò Suporte e Logs

### Tipos de Log
- **INFO:** Opera√ß√µes normais
- **WARNING:** Avisos (continua√ß√£o poss√≠vel)
- **ERROR:** Erros cr√≠ticos (interrup√ß√£o)
- **SUCCESS:** Opera√ß√µes bem-sucedidas

### Arquivo de Erro
- Gerado automaticamente: `error_report.log`
- Cont√©m apenas WARNING e ERROR
- √ötil para an√°lise posterior

### Salvando Logs do Launcher
- Use bot√£o "Salvar Logs" na interface
- Escolha local e nome do arquivo
- Formato `.log` ou `.txt`

---

## üéâ Conclus√£o

Este sistema oferece uma solu√ß√£o completa para automatizar fechamentos financeiros a partir de PDFs, com interface gr√°fica amig√°vel e resultados profissionais em Excel.

**Para d√∫vidas ou problemas, consulte os logs detalhados ou entre em contato com o suporte t√©cnico.**# MagaluPDF
